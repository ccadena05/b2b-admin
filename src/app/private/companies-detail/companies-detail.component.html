<div #cc class="bg-slate-100 rounded-2xl shadow-lg p-6">
    <div class="sticky top-0 right-10 left-full w-[7.5rem] z-50 justify-end text-slate-100 rounded-2xl flex gap-x-2">
        <span class="relative flex h-12 w-12">
            <span #ping class="absolute inline-flex h-full w-full rounded-2xl bg-sky-400 opacity-75"></span>
            <button (click)="save()" class="relative rounded-2xl p-3 h-12 bg-b2b-2">
                <mat-icon>save</mat-icon>
            </button>
            <!-- <span class="relative inline-flex rounded-full h-3 w-3 bg-sky-500"></span> -->
        </span>
        <button [matMenuTriggerFor]="addLang" class="rounded-2xl p-3 h-12 bg-b2b-2">
            <mat-icon>translate</mat-icon>
        </button>

        <mat-menu #addLang="matMenu">
            <button class="text-slate-100 disabled:text-slate-500" mat-menu-item
                *ngFor="let lang of available_langs; let i = index" [disabled]="lang.id == tabs[i]?.id"
                (click)="lang.id == tabs[i]?.id ? '' : addTab(lang)">
                <span class="ml-2"
                    [ngClass]="lang.id == tabs[i]?.id ? 'opacity-15' : 'opacity-100'">{{lang?.emoji}}</span>
                <span class="ml-2"
                    [ngClass]="lang.id == tabs[i]?.id ? 'opacity-15' : 'opacity-100'">{{lang?.name}}</span>
            </button>
        </mat-menu>
    </div>

    <mat-tab-group>
        <mat-tab *ngFor="let tab of tabs; let i = index">
            <ng-template mat-tab-label class="w-full flex gap-x-2">
                <span class="ml-2">{{tab?.emoji}}</span>
                <span class="ml-2">{{tab?.name}}</span>
                <mat-icon class="ml-4" (click)="deleteTab(i, tab.id)"
                    *ngIf="this.tabs.length > 1 && i !== 0 && tab.id !== 1">close</mat-icon>
            </ng-template>

            <div class="flex flex-col gap-y-6">

                <mat-tab-group>
                    <form [formGroup]="form">

                        <mat-tab label="Información General">
                            <div [ngClass]="cc.offsetWidth <= 640 ? 'grid-cols-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'grid-cols-2' : 'grid-cols-3'"
                                class="grid gap-x-6 w-full">

                                <div class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                    Información de la empresa
                                </div>

                                <div class="flex gap-x-6"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                    <mat-slide-toggle class="mb-6 w-full"
                                        formControlName="hidden">Oculto</mat-slide-toggle>
                                    <mat-slide-toggle class="mb-6 w-full"
                                        formControlName="validated">Validado</mat-slide-toggle>
                                </div>

                                <div class="grow" formArrayName="legal_name"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                    <div *ngFor="let item of master.getterA(form.controls['legal_name']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Razón social</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresar un valor válido *</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Nombre comercial</mat-label>
                                    <input formControlName="friendly_name" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <div class="flex gap-x-3">
                                    <!-- <img *ngIf="form.value.image_url" [src]="form.value.image_url" alt="" class="h-10 mt-1 rounded-lg aspect-square grow-0"> -->
                                    <div (click)="uploadPDF(form.get('image_url'))" class="file-field" *ngIf="i == 0"
                                        [ngClass]="form.controls['image_url'].invalid && form.controls['image_url'].touched ? 'border-red-500 text-red-500' : ''">
                                        <mat-icon *ngIf="!form.value.image_url"
                                            class="text-[rgba(0,0,0,.54)]">upload_file</mat-icon>
                                        <img *ngIf="form.value.image_url" [src]="form.value.image_url" alt=""
                                            class="h-8 rounded-lg aspect-square grow-0">
                                        <div class="absolute left-11"
                                            [ngClass]="form.value.image_url ? 'top-0 text-xs' : ''">
                                            Logo
                                        </div>
                                        <div class="max-w-[12rem] overflow-hidden whitespace-nowrap">
                                            {{form.value.image_url ?? ''}}
                                        </div>
                                    </div>
                                </div>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>RFC</mat-label>
                                    <input formControlName="rfc" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Email</mat-label>
                                    <input formControlName="email_company" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <div #phone class="w-full flex gap-x-3" *ngIf="i == 0">
                                    <div #pc class="w-full max-w-[6rem]">
                                        <search-select [label]="'Código'" [select]="sel['countries']"
                                            [control]="form.controls['phone_code']" class="w-full"></search-select>
                                    </div>

                                    <mat-form-field appearance="outline" class="w-full"
                                        [ngStyle]="{'max-width.px' : phone.offsetWidth - pc.offsetWidth - 12}">
                                        <mat-label>Teléfono</mat-label>
                                        <input formControlName="phone" type="text" matInput>
                                        <mat-error>Ingresar un valor válido *</mat-error>
                                    </mat-form-field>
                                </div>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Ext</mat-label>
                                    <input formControlName="ext" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Conmutador</mat-label>
                                    <input formControlName="phone_switch" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Fax</mat-label>
                                    <input formControlName="phone_fax" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <div class="w-full" formArrayName="main_activity">
                                    <div *ngFor="let item of master.getterA(form.controls['main_activity']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Productos y servicios principales</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresar un valor válido *</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Creación empresa</mat-label>
                                    <input formControlName="start_year" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <search-select [label]="'Giro de empresa'" [select]="sel['type_company']"
                                    [control]="form.controls['type_company_id']" class="w-full"></search-select>

                                <search-select *ngIf="i == 0" [label]="'País de origen'" [select]="sel['countries']"
                                    [control]="form.controls['country_origin']" class="w-full"></search-select>

                                <search-select [label]="'Mebresía'" [select]="sel['type_company']"
                                    [control]="form.controls['membership']" class="w-full"></search-select>

                                <mat-form-field appearance="outline" class="" *ngIf="i == 0">
                                    <mat-label>Fechas de membresía</mat-label>
                                    <mat-date-range-input [rangePicker]="picker">
                                        <input matStartDate formControlName="membership_start_date"
                                            placeholder="Inicio">
                                        <input matEndDate formControlName="membership_end_date" placeholder="Fin">
                                    </mat-date-range-input>
                                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-date-range-picker #picker></mat-date-range-picker>

                                    <mat-error>Ingresa un valor válido</mat-error>

                                </mat-form-field>


                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Límite de usuarios</mat-label>
                                    <mat-icon class="text-slate-900" matPrefix
                                        (click)="user_limit.valueAsNumber = user_limit.valueAsNumber - 1">remove</mat-icon>

                                    <input #user_limit formControlName="user_limit" type="number" matInput [value]="0">
                                    <mat-icon class="text-slate-900" matSuffix
                                        (click)="user_limit.valueAsNumber = user_limit.valueAsNumber + 1">add</mat-icon>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Límite de productos</mat-label>
                                    <mat-icon class="text-slate-900" matPrefix
                                        (click)="product_limit.valueAsNumber = product_limit.valueAsNumber - 1">remove</mat-icon>

                                    <input #product_limit formControlName="product_limit" type="number" matInput
                                        [value]="0">
                                    <mat-icon class="text-slate-900" matSuffix
                                        (click)="product_limit.valueAsNumber = product_limit.valueAsNumber + 1">add</mat-icon>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Límite de usuarios activos</mat-label>
                                    <mat-icon class="text-slate-900" matPrefix
                                        (click)="active_user_limit.valueAsNumber = active_user_limit.valueAsNumber - 1">remove</mat-icon>

                                    <input #active_user_limit formControlName="active_user_limit" type="number" matInput
                                        [value]="0">
                                    <mat-icon class="text-slate-900" matSuffix
                                        (click)="active_user_limit.valueAsNumber = active_user_limit.valueAsNumber + 1">add</mat-icon>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-divider class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0"></mat-divider>

                                <div class="title" class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">
                                    Ubicación
                                </div>

                                <div *ngIf="i == 0" class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    id="map" #map class="aspect-[3/1] basis-full mb-4 rounded-2xl"></div>
                                <div *ngIf="i == 0" class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    class="flex justify-center items-center mb-6">
                                    <div class="btn-p mx-auto" (click)="getLocation()">
                                        Obtener Información
                                    </div>
                                </div>

                                <location [form]="form" *ngIf="i == 0"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                </location>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Código Postal </mat-label>
                                    <input formControlName="zip" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Colonia</mat-label>
                                    <input formControlName="address_2" type="text" matInput [matAutocomplete]="auto">
                                    <mat-autocomplete #auto="matAutocomplete">
                                        <mat-option *ngFor="let item of location?.asentamientos_cp"
                                            [value]="item">{{item}}</mat-option>
                                    </mat-autocomplete>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Cobertura</mat-label>
                                    <input formControlName="branch" type="text" matInput>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">
                                    <mat-label>Calle</mat-label>
                                    <textarea formControlName="address_1" type="text" matInput></textarea>
                                    <mat-error>Ingresar un valor válido *</mat-error>
                                </mat-form-field>

                            </div>

                        </mat-tab>

                        <mat-tab label="Detalles De La Empresa">
                            <div [ngClass]="cc.offsetWidth <= 640 ? 'grid-cols-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'grid-cols-2' : 'grid-cols-3'"
                                class="grid gap-x-6 w-full">

                                <div class="title" class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">Detalles de la empresa</div>

                                <div class="label w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">
                                    Categorías
                                </div>

                                <mat-form-field appearance="outline" class="w-full" *ngIf="i == 0">
                                    <mat-label>Página web</mat-label>
                                    <input formControlName="web_page" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <div (click)="uploadPDF(form.get('brochure_url'))"
                                    class="file-field" *ngIf="i == 0">
                                    <mat-icon>upload_file</mat-icon>
                                    <div class="absolute left-11"
                                        [ngClass]="form.value.brochure_url ? 'top-0 text-xs' : ''">
                                        Brochure
                                    </div>
                                    {{form.value.brochure ?? ''}}
                                </div>

                                <mat-form-field class="w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    appearance="outline" *ngIf="i == 0">
                                    <mat-label>Etiquetas</mat-label>
                                    <mat-chip-list #chipList formControlName="tags">
                                        <!-- <mat-chip *ngFor="let tag of form.value.tags?.split(',')"
                                            (removed)="removeTag(tag)">
                                            {{tag}}
                                            <button matChipRemove>
                                                <mat-icon>cancel</mat-icon>
                                            </button>
                                        </mat-chip> -->
                                        <input [matChipInputFor]="chipList"
                                            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                            [matChipInputAddOnBlur]="true" (matChipInputTokenEnd)="addTag($event)">
                                    </mat-chip-list>
                                </mat-form-field>

                                <div class="w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    formArrayName="description">
                                    <div *ngFor="let item of master.getterA(form.controls['description']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Descripcion breve</mat-label>
                                            <textarea formControlName="text" type="text" matInput
                                                maxlength="250"></textarea>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                            <mat-hint class="text-[#bbbdc3]">{{item?.value?.text?.length ?? 0 + '/' +
                                                250}}</mat-hint>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    formArrayName="description_detail">
                                    <div *ngFor="let item of master.getterA(form.controls['description_detail']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Descripción detallada</mat-label>
                                            <textarea formControlName="text" type="text" matInput></textarea>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>


                                <div class="title" class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">General</div>

                                <div class="label w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">Horario</div>
                                <div formGroupName="schedule_week" class="flex flex-wrap mb-3 w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">

                                    <div *ngFor="let day of days" class="basis-full flex gap-x-3 items-center">
                                        <div class="flex basis-1/4 gap-x-6 mb-3 text-slate-900">
                                            <div class="basis-36">
                                                {{day.name}}
                                            </div>
                                            <mat-slide-toggle #a [formControlName]="day.id + '_tg'"></mat-slide-toggle>
                                        </div>
                                        <mat-form-field *ngIf="a.checked" class="w-full" appearance="outline">
                                            <mat-label>Horario</mat-label>
                                            <input [formControlName]="day.id" type="text" matInput
                                                [required]="a.checked">
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>


                                </div>

                                <div class="w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    formArrayName="company_payment">
                                    <div *ngFor="let item of master.getterA(form.controls['company_payment']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Facilidades de pago</mat-label>
                                            <textarea formControlName="text" type="text" matInput></textarea>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">
                                    <div class="basis-full flex flex-col mb-3">
                                        <div class="label w-full">
                                            ¿Te gustaría que Cluster Industrial te apoye contactando empresas?
                                        </div>
                                        <mat-radio-group formControlName="consi" class="flex gap-x-3 mb-3"
                                            (change)="toogleValidators(consi.checked, ['support_clients', 'service_cluster'])">
                                            <mat-radio-button class="basis-16 grow-0" [value]="true"
                                                #consi>Sí</mat-radio-button>
                                            <mat-radio-button class="basis-16 grow-0"
                                                [value]="false">No</mat-radio-button>
                                        </mat-radio-group>
                                    </div>

                                    <div class="basis-full grow flex flex-col duration-300"
                                        [ngClass]="consi.checked ? 'h-[11rem]' : 'h-0 overflow-hidden'">
                                        <mat-form-field class="w-full"
                                            [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                            appearance="outline">
                                            <mat-label>¿Con qué clientes y empresas le gustaria que le apoyaramos para
                                                contactar?</mat-label>
                                            <input formControlName="support_clients" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>

                                        <mat-form-field class="w-full"
                                            [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                            appearance="outline">
                                            <mat-label>¿Qué tipo de servicio le gustaría recibir por parte de Cluster
                                                Industrial?</mat-label>
                                            <input formControlName="service_cluster" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="w-full flex flex-row-reverse"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                    <mat-icon class="text-[#bbbdc3]">help</mat-icon>
                                    <div class="title w-full"
                                        [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                        Procesos de la empresa
                                    </div>
                                </div>

                                <div class="flex flex-col mb-3 w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                    <div class="label w-full">
                                        ¿Tu empresa cuenta con procesos industriales?
                                    </div>
                                    <mat-radio-group formControlName="pisi" class="flex gap-x-3 mb-3"
                                        (change)="toogleValidators(pisi.checked, ['main_processes', 'production_capacity', 'machinery'])">
                                        <mat-radio-button class="basis-16 grow-0" [value]="true"
                                            #pisi>Sí</mat-radio-button>
                                        <mat-radio-button class="basis-16 grow-0" [value]="false">No</mat-radio-button>
                                    </mat-radio-group>
                                </div>

                                <div *ngIf="pisi.checked" class="w-full" formArrayName="main_processes">
                                    <div *ngFor="let item of master.getterA(form.controls['main_processes']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Procesos principales de la empresa</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div *ngIf="pisi.checked" class="w-full" formArrayName="production_capacity">
                                    <div *ngFor="let item of master.getterA(form.controls['production_capacity']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Capacidad de producción instalada / disponible</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div *ngIf="pisi.checked" class="w-full" formArrayName="machinery">
                                    <div *ngFor="let item of master.getterA(form.controls['machinery']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Maquinaria con la que cuenta</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div *ngIf="pisi.checked" class="w-full" formArrayName="guarantees_offered">
                                    <div *ngFor="let item of master.getterA(form.controls['guarantees_offered']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Garantías ofrecidas por la empresa</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="title" class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                    *ngIf="i == 0">
                                    Redes sociales
                                </div>

                                <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0">
                                    <mat-label>Facebook</mat-label>
                                    <mat-icon matPrefix><i class="fa-brands fa-facebook text-[#bbbdc3]"></i></mat-icon>
                                    <input formControlName="facebook" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0">
                                    <mat-label>Twitter</mat-label>
                                    <mat-icon matPrefix><i
                                            class="fa-brands fa-twitter text-[#bbbdc3] !mb-4"></i></mat-icon>
                                    <input formControlName="twitter" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0">
                                    <mat-label>Linkedin</mat-label>
                                    <mat-icon matPrefix><i class="fa-brands fa-linkedin text-[#bbbdc3]"></i></mat-icon>
                                    <input formControlName="linkedin" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0">
                                    <mat-label>Vídeo de youtube</mat-label>
                                    <mat-icon matPrefix><i class="fa-brands fa-youtube text-[#bbbdc3]"></i></mat-icon>
                                    <input formControlName="youtube" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <div class="title w-full"
                                    [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                    Información estadística de la empresa
                                </div>

                                <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0">
                                    <mat-label>Número aproximado de empleados</mat-label>
                                    <input formControlName="number_employees" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0">
                                    <mat-label>Volumen de ventas</mat-label>
                                    <input formControlName="turnover" type="text" matInput>
                                    <mat-error>Ingresa un valor válido</mat-error>
                                </mat-form-field>

                                <div class="w-full" formArrayName="specialization">
                                    <div *ngFor="let item of master.getterA(form.controls['specialization']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Especialización industrial</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="w-full" formArrayName="another_sector">
                                    <div *ngFor="let item of master.getterA(form.controls['another_sector']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>Otro sector</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="w-full" formArrayName="relevant_products">
                                    <div *ngFor="let item of master.getterA(form.controls['relevant_products']).controls; let i = index"
                                        [formGroupName]="i">
                                        <mat-form-field class="w-full" appearance="outline"
                                            *ngIf="item.value.languages_id == tab.id">
                                            <mat-label>¿Qué productos relevantes importa?</mat-label>
                                            <input formControlName="text" type="text" matInput>
                                            <mat-error>Ingresa un valor válido</mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </mat-tab>
                        <mat-tab label="Capacidades Y Certificaciones">
                            <div class="title" class="title w-full"
                                [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'"
                                *ngIf="i == 0">
                                Capacidades y certificaciones
                            </div>

                            <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0"
                                [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                <mat-label>Premios de calidad obtenidos, reconocimientos</mat-label>
                                <input formControlName="quality_awards" type="text" matInput>
                                <mat-error>Ingresa un valor válido.</mat-error>
                            </mat-form-field>

                            <mat-form-field class="w-full" appearance="outline" *ngIf="i == 0"
                                [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                <mat-label>Certificaciones</mat-label>
                                <mat-select (selectionChange)="toggle_iso($event)" formControlName="cert" multiple>
                                    <mat-option *ngFor="let _ce of cert"
                                        value="{{_ce.name_id.toString()}}">{{_ce.name}}</mat-option>
                                </mat-select>
                            </mat-form-field>

                            <div class="w-full" formArrayName="isos" *ngIf="i == 0"
                                [ngClass]="cc.offsetWidth <= 640 ? 'col-span-1' : cc.offsetWidth > 640 && cc.offsetWidth < 768 ? 'col-span-2' : 'col-span-3'">
                                <div *ngFor="let item of master.getterA(form.controls['isos']).controls; let i = index"
                                    [formGroupName]="i">
                                    <div class="flex justify-center items-center gap-x-3 text-slate-100"
                                        *ngIf="item.value.active == '1'">
                                        <div class="basis-48 grow">
                                            {{item.value.name}}
                                        </div>
                                        <div class="file-field" #filefield
                                            (click)="uploadPDF(master.getterA(form.controls['isos']).at(i).get('url'))">
                                            <mat-icon>upload_file</mat-icon>
                                            <div class="absolute left-11"
                                                [ngClass]="item.value.url ? 'top-0 text-xs' : ''">
                                                Comprobante
                                            </div>
                                            <div [ngStyle]="{'max-width.px' : filefield.offsetWidth - 92}"
                                                class=" truncate">
                                                {{item.value.url ?? ''}}
                                            </div>
                                        </div>
                                        <a href="{{item.value.url}}"
                                            target="_blank"><mat-icon>open_in_new</mat-icon></a>
                                    </div>
                                </div>
                            </div>
                        </mat-tab>
                        <mat-tab label="Productos">
                            <app-mat-table [dataToDisplay]="products"></app-mat-table>
                        </mat-tab>
                        <mat-tab label="Servicios">
                            <app-mat-table [dataToDisplay]="products"></app-mat-table>
                        </mat-tab>
                        <mat-tab label="RFQ">
                            <div class="w-full flex items-end justify-end">
                                <button (click)="addrfq()"
                                    class="bg-b2b-2 text-white h-12 w-12 shrink-0 grow-0 flex justify-center items-center rounded-xl">
                                    <mat-icon class="m-auto">add</mat-icon>
                                </button>
                            </div>
                            <app-mat-table [dataToDisplay]="requierements" [action]="edit"></app-mat-table>
                        </mat-tab>
                    </form>
                </mat-tab-group>
            </div>
        </mat-tab>
    </mat-tab-group>

</div>